# LBPay intelliCore - Example GraphQL Queries

# ============================================
# OBJECT TYPES
# ============================================

# Create ObjectType
mutation CreateObjectType {
  createObjectType(input: {
    name: "Cliente PF"
    description: "Cliente Pessoa Física - CPF"
    is_active: true
  }) {
    id
    name
    description
    is_active
    created_at
    updated_at
  }
}

# Query all ObjectTypes with pagination
query GetObjectTypes {
  objectTypes(first: 10) {
    nodes {
      id
      name
      description
      is_active
      created_at
      updated_at
    }
    pageInfo {
      hasNextPage
      endCursor
    }
    totalCount
  }
}

# Query single ObjectType by ID
query GetObjectType {
  objectType(id: "YOUR_UUID_HERE") {
    id
    name
    description
    is_active
    fields {
      id
      name
      field_type
      is_required
      validation_rules
    }
    created_at
    updated_at
  }
}

# Update ObjectType
mutation UpdateObjectType {
  updateObjectType(input: {
    id: "YOUR_UUID_HERE"
    name: "Cliente Pessoa Física"
    description: "Cliente PF atualizado"
    is_active: true
  }) {
    id
    name
    description
    is_active
    updated_at
  }
}

# Delete ObjectType
mutation DeleteObjectType {
  deleteObjectType(id: "YOUR_UUID_HERE")
}

# ============================================
# FIELDS
# ============================================

# Create Field
mutation CreateField {
  createField(input: {
    object_type_id: "YOUR_OBJECT_TYPE_UUID"
    name: "cpf"
    field_type: STRING
    is_required: true
    validation_rules: {
      pattern: "\\d{11}",
      minLength: 11,
      maxLength: 11
    }
  }) {
    id
    name
    field_type
    is_required
    validation_rules
    created_at
  }
}

# Create multiple fields
mutation CreateMultipleFields {
  nome: createField(input: {
    object_type_id: "YOUR_OBJECT_TYPE_UUID"
    name: "nome"
    field_type: STRING
    is_required: true
  }) {
    id
    name
  }

  email: createField(input: {
    object_type_id: "YOUR_OBJECT_TYPE_UUID"
    name: "email"
    field_type: STRING
    is_required: true
    validation_rules: {
      pattern: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"
    }
  }) {
    id
    name
  }

  dataNascimento: createField(input: {
    object_type_id: "YOUR_OBJECT_TYPE_UUID"
    name: "data_nascimento"
    field_type: DATE
    is_required: true
  }) {
    id
    name
  }

  ativo: createField(input: {
    object_type_id: "YOUR_OBJECT_TYPE_UUID"
    name: "ativo"
    field_type: BOOLEAN
    is_required: false
  }) {
    id
    name
  }
}

# Query all Fields
query GetAllFields {
  fields {
    id
    name
    field_type
    is_required
    validation_rules
    objectType {
      id
      name
    }
  }
}

# Query Fields by ObjectType
query GetFieldsByObjectType {
  fieldsByObjectType(objectTypeId: "YOUR_OBJECT_TYPE_UUID") {
    id
    name
    field_type
    is_required
    validation_rules
    created_at
  }
}

# Query single Field
query GetField {
  field(id: "YOUR_FIELD_UUID") {
    id
    name
    field_type
    is_required
    validation_rules
    objectType {
      id
      name
      description
    }
    created_at
    updated_at
  }
}

# Update Field
mutation UpdateField {
  updateField(input: {
    id: "YOUR_FIELD_UUID"
    name: "cpf_atualizado"
    is_required: false
  }) {
    id
    name
    is_required
    updated_at
  }
}

# Delete Field
mutation DeleteField {
  deleteField(id: "YOUR_FIELD_UUID")
}

# ============================================
# COMPLEX QUERIES
# ============================================

# Complete ObjectType with all Fields
query CompleteObjectType {
  objectType(id: "YOUR_OBJECT_TYPE_UUID") {
    id
    name
    description
    is_active
    created_at
    updated_at
    fields {
      id
      name
      field_type
      is_required
      validation_rules
      created_at
    }
  }
}

# All ObjectTypes with Fields (paginated)
query AllObjectTypesWithFields {
  objectTypes(first: 20) {
    nodes {
      id
      name
      description
      is_active
      fields {
        id
        name
        field_type
        is_required
      }
    }
    pageInfo {
      hasNextPage
      endCursor
    }
    totalCount
  }
}

# ============================================
# EXAMPLE: Create Complete Object Type
# ============================================

# Step 1: Create ObjectType "Cliente PJ"
mutation Step1_CreateObjectType {
  createObjectType(input: {
    name: "Cliente PJ"
    description: "Cliente Pessoa Jurídica - CNPJ"
    is_active: true
  }) {
    id
    name
  }
}

# Step 2: Add Fields to Cliente PJ (use ID from Step 1)
mutation Step2_AddFields {
  cnpj: createField(input: {
    object_type_id: "REPLACE_WITH_ID_FROM_STEP1"
    name: "cnpj"
    field_type: STRING
    is_required: true
    validation_rules: { pattern: "\\d{14}" }
  }) { id name }

  razaoSocial: createField(input: {
    object_type_id: "REPLACE_WITH_ID_FROM_STEP1"
    name: "razao_social"
    field_type: STRING
    is_required: true
  }) { id name }

  nomeFantasia: createField(input: {
    object_type_id: "REPLACE_WITH_ID_FROM_STEP1"
    name: "nome_fantasia"
    field_type: STRING
    is_required: false
  }) { id name }

  dataAbertura: createField(input: {
    object_type_id: "REPLACE_WITH_ID_FROM_STEP1"
    name: "data_abertura"
    field_type: DATE
    is_required: true
  }) { id name }

  ativo: createField(input: {
    object_type_id: "REPLACE_WITH_ID_FROM_STEP1"
    name: "ativo"
    field_type: BOOLEAN
    is_required: false
  }) { id name }
}

# Step 3: Query the complete ObjectType
query Step3_ViewComplete {
  objectType(id: "REPLACE_WITH_ID_FROM_STEP1") {
    id
    name
    description
    is_active
    fields {
      id
      name
      field_type
      is_required
      validation_rules
    }
  }
}

# ============================================
# AUTHENTICATION EXAMPLES
# ============================================

# To use authentication, add this HTTP header in GraphQL Playground:
# {
#   "Authorization": "Bearer YOUR_JWT_TOKEN_FROM_KEYCLOAK"
# }

# Protected mutation (requires authentication)
mutation ProtectedCreate {
  createObjectType(input: {
    name: "Conta Corrente"
    description: "Conta bancária corrente"
  }) {
    id
    name
  }
}

# ============================================
# PAGINATION EXAMPLES
# ============================================

# First page (10 items)
query FirstPage {
  objectTypes(first: 10) {
    nodes {
      id
      name
    }
    pageInfo {
      hasNextPage
      endCursor
    }
  }
}

# Next page (use endCursor from previous query)
query NextPage {
  objectTypes(first: 10, after: "CURSOR_FROM_PREVIOUS_QUERY") {
    nodes {
      id
      name
    }
    pageInfo {
      hasNextPage
      endCursor
    }
  }
}
